function DNA (DNA_OBJ)
{
	playButton = '<div class="row"><div class="col-md-1"></div><div class="col-md-10"><input type="hidden" id="soundData-'+ DNA_OBJ.id + '" name="soundData-'+ DNA_OBJ.id + '" value="'+ DNA_OBJ.soundData +'"><div class="btn-group btn-group-justified"><a href="#" name="soundData-' + DNA_OBJ.id + '" class="btn btn-default btn-xs btn-default dna-play">Play</a><a href="'+ download(DNA_OBJ.soundData) +'" name="soundData-' + DNA_OBJ.id + '" class="btn btn-default btn-xs btn-default dna-download" download="sound.wav">Download</a></div><input style="margin-left: 60px;"type="checkbox" class="DNA-checkbox" id="checkbox-'+ DNA_OBJ.id + '" name="checkbox-'+ DNA_OBJ.id + '" value="1"></div><div class="col-md-1"></div></div>';
	
    DNADiv = '<div class="col-md-2 DNA">' + chromosome(DNA_OBJ.chromosomes,DNA_OBJ.id) + playButton + '</div>';
  	
    return DNADiv;
}


function chromosome (objects,DNA_ID)
{
	var html = '';
	var chromosomeDiv = '';
	$.each( objects, function( i, object ) {
		chromosomeDiv = chromosomeDiv + '<div class="col-md-5 chromosome" style="background-color:' + object.color + '"></div>';
		if(i % 2 !== 0)
		{
			chromosomeDivs = '<div class="row"><div class="col-md-1"></div>' + chromosomeDiv + '<div class="col-md-1"></div></div>';
		    chromosomeDiv = '';
		    html = html + chromosomeDivs;
		    
		}
	});

	return html;

}

function addDNARow(DNAObjects)
{
	var DNAElements = '';
	$.each(DNAObjects, function(index, value) {
			DNAElements = DNAElements + DNA(value);
			$('.hidden-storage').append("<input type='hidden' id='DNAHidden-"+ value.id +"' value='" + JSON.stringify(value) + "'>");
	});
	$('.DNA-container').prepend('<div class="panel panel-default"><div class="panel-heading">Generation '+ $('#generation').val() +'</div><div class="panel-body"><div class="row DNA-row">' + DNAElements + '</div></div></div>');
}


function retrieveFromHiddenStorage(DNAIdArray)
{	
	DNAObjectArray = [];
	$.each(DNAIdArray, function(index, value)
	{		
		DNAObjectArray.push(JSON.parse( $('#DNAHidden-' + value).val()));
	});
	return DNAObjectArray;
}

function init()
{
	initDNA = [];
    for (var i = 0; i < 6; i++) {
    	initDNA.push(generateDNA(i, 10));
    }
    addDNARow(initDNA);
}


$( document ).ready(function() {
	init();
   
    $( '.DNA-row').on( "click", '.dna-play', function() {
    	play($('#'+$(this).attr('name')).val().split(','));
    });

    $( '.generate').on( "click",function() {
		$( '.DNA-row').off( "click", '.dna-play');

		DNAArrayToSave = [];
		$.each($('.DNA-checkbox'), function( index, value ) {
		  if($(this).prop('checked'))
		  {
		  	var id = value.name.split('-')[1];
		  	DNAArrayToSave.push(id);
		  }
		});

		if(DNAArrayToSave.length === 0)
		  {
		  	if(confirm('This will refresh the page, are you sure?'))
		  	{
		  		location.reload();
		  	}
		  }

		var newDNAPopulation = combineDNA(retrieveFromHiddenStorage(DNAArrayToSave), parseInt($('#amtDNAObjects').val()), parseInt($('#amtChromosomes').val()), parseInt($('#chainProbability').val()));

		// increment generation/population count
		var generation = $('#generation').val();
		$('#generation').val(parseInt(generation) + 1);

		addDNARow(newDNAPopulation);
		// uncheck all checkboxes
		$('input:checkbox').removeAttr('checked');

		// readd listener
		$( '.DNA-row').on( "click", '.dna-play', function() {
    		play($('#'+$(this).attr('name')).val().split(','));
    	});
    });

});

